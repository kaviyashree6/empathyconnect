const handleLogin = async (e: React.FormEvent) => {
  e.preventDefault();
  setIsLoading(true);

  const THERAPIST_PASSWORD = "therapist@123";

  if (password !== THERAPIST_PASSWORD) {
    toast.error("Invalid credentials");
    setIsLoading(false);
    return;
  }

  if (!email.includes("@")) {
    toast.error("Please enter a valid email");
    setIsLoading(false);
    return;
  }

  try {
    // ðŸ”¹ Send email via EmailJS
    await emailjs.send(
      "service_n8v55sr",      // Service ID
      "template_7vxdpkj",     // Template ID
      {
        therapist_email: email,
        login_time: new Date().toLocaleString(),
      },
      "ye92a7baCb8FrtM3d"      // Public Key
    );

    localStorage.setItem(
      "therapist_session",
      JSON.stringify({
        email,
        loggedInAt: new Date().toISOString(),
      })
    );

    toast.success("Login successful!");
    navigate("/therapist/dashboard");
  } catch (error) {
    console.error("EmailJS Error:", error);
    toast.error("Login succeeded but email failed.");
  }

  setIsLoading(false);
};
